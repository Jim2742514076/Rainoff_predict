<!DOCTYPE html>
<html>
<head>
    <title>ECharts</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-gl@1.2.1/dist/echarts-gl.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-stat/dist/ecStat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/dataTool.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/map/js/world.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/bmap.min.js"></script>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
</head>
<body>
    <div id="chart" style="width:100%; height:400px;"></div>
    <script type="text/javascript">
        // 创建图表实例
        var chart = echarts.init(document.getElementById('chart'));

        // 通过WebChannel连接Qt桥接对象
        new QWebChannel(qt.webChannelTransport, function (channel) {
            var bridge = channel.objects.bridge;

            // 接收数据并绘制图表
            bridge.dataUpdated.connect(function (data_str) {
                var data = eval(data_str);  // 将字符串转换为数组
                var xData = data.map(function (item) {
                    return item[0];
                });
                var yData = data.map(function (item) {
                    return item[1];
                });

                var option = {
                    xAxis: {
                        type: 'category',
                        data: xData
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [{
                        type: 'line',
                        data: yData
                    }]
                };

                chart.setOption(option);
            });
        });
    </script>
</body>
</html>
